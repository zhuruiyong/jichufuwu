## 数据库

数据库的特点：实现数据共享，减少数据冗余；采用特定的数据类型；具有较高的数据独立性；具有统一的数据控制功能。

表：在关系型数据库中，数据库的表是一系列二维数组的集合，用来存储数据和操作数据的逻辑结构。它是由纵向的列和横向的行组成，行被称为记录，是组织数据的单位；列被称为字段，每一列表示记录的一个属性，都有相应的描述信息。

数据类型:数据类型决定了数据在计算机中的存储格式，代表不同的信息类型。常用的数据类型有：整数数据类型、浮点数数据类型、精确小数类型、二进制数据类型、日期/随时间数据类型、字符串数据类型

主键（Primary Key）：用于唯一的标识表中的每一条记录。可以定义表中的一列或多列为主键。主键列上不能有两行相同的值，也不能为空值

数据可技术构成：数据库系统由硬件部分和软件部分共同构成，硬件主要用于存储数据库中的数据，包括计算机、存储设备等。软件部分则主要包括DBMS、支持DBMS运行的操作系统，以及支持多种语言进行应用开发的访问技术等。

数据库系统由3个主要的组成部分：

数据库：用于存储数据的地方

数据库管理系统：用于管理数据库的软件

数据库应用程序：

## SQL语言

对数据库进行查询和修改操作的语言叫做sql

sql语言包含4部分

1.数据定义语言  DDL（Data Defination language）:CREATE创建、ALTER修改、DROP删除（针对库和表而言）

2.数据操作语言	DML(Data Manipulation Language)： INSERT写入 、   UPDATE修改、	DELETE删除（针对数据）

3.数据查询语言	DQL(Data  Query  Language)： SELECT查询（针对数据）

4.数据控制语言	DCL(Data Control Language)：GRANT授权	、REVOKE收回授权、	ROLLBACK回滚	、COMMIT提交（针对用户或者功能的控制）

## 查看当前mysql版本的命令

select version();

## mysql的优点

1.速度快

2.开源免费

3.移植性强

4.客户端语言多

5.功能丰富

6.安全性和连续性

查看当前数据库的命令

show  databases;

分号（;）作为mysql中的结束符，mysql不止只有一个结束符还有\g等同于分号和\G去掉表结构的方式，使数据以更直观的方式进行呈现

切换mysql 的结束符

delimiter	要使用的结束符

information_schema:mysql中的信息库，用于存放所有mysql维护的库信息以及表的信息

mysql：记录了mysql中所有用户信息，包含权限，关键字，密码等相关信息

performance_schema：5.5版本之后推出的库，用于收集服务器性能参数

test：测试库（作为测试库生产环境中，不会向该库存放重要信息）

创建数据库相当于在磁盘上划分一块区域用于数据的存放和管理

## 创建数据库的命令

create database 数据库名

## 删除数据库的命令

删除数据库时，数据库中的表和数据会随着库的删除而一并删除，所以删库要慎重（否则，容易获赔60万，打断腿）

drop database 数据库名

## 					存储引擎

属于mysql底层组件，提供mysql的增删改查，使用不同的存储引擎可以得到不同的功能，例如使用的索引类型，事务的支持与否，或者锁定功能等等都要根据不同存储引擎来决定，

属于mysql的核心

查看当前mysql拥有那些存储引擎的命令

show	engines\G

```
      Engine: InnoDB	引擎名
     Support: DEFAULT	mysql是否支持改种引擎
     Comment: Supports transactions, row-level locking, and foreign keys		mysql对改种引擎的描述
Transactions: YES		是否支持事物
          XA: YES		是否支持分布式事务
  Savepoints: YES		是否支持事务保存点

mysql> show variables like 'default_storage_engine';	#查看当前默认存储引擎
show  variables	like	'参数'	#查看系统参数的工具
```

存储引擎

一旦选择了存储引擎就表示存放数据的格式，不同存储引擎使用的功能不相同，占用的空间也不相同，每个表都将有且仅有一个存储引擎与之对应

MylSAM存储引擎特点：

（1）在mysql5.5版本之前属于默认存储引擎，之后由InnoDB进行替代

（2）MyISAM存储引擎读取效率高，占用资源少，不支持事务，不支持外键，支持全文索引

（3）读写相互阻塞

（4）只能缓存索引，不能缓存数据 

MyISAM适用场景

（1）不支持事务的业务

（2）适用于读取数据较多的业务，不适用于写频繁的业务

（3）并发较低的业务

（4）硬件资源差的服务器可以使用

InnoDB特点

（1）既能缓存索引，又能缓存数据

  (2) 支持事务，支持外键，支持行级别锁定，且属于5.5版本之后的默认存储

（3）具有提交回滚，崩溃恢复能力的事务安全存储引擎，可以支持较大并发量

（4）使用InnoDB时，会在数据目录下生成两个名字为ib_logfile0和ib_logfile1的5M大小的日志文件，和一个10M大小的自动扩展的名为ibdata1的数据文件

InnoDB的适用场景

（1）需要使用事务的业务

（2）数据更新频繁的业务

（3）数据一致性要求较高的业务

Memory特点

（1）将数据保存在内存中，方便快速的引用和查找

（2）Memory支持btree和hash索引，不支持建立blob和text列

（3）如果不需要memory表中的数据，直接清空表，或者删除掉该表可以快速释放内存中的空间

选择合适的存储引擎可以方便我们的使用，

```
InnoDB可以在使用淘宝，或者充值充值业务时进行使用，
MyISAM可以建立在黄页时进行使用，
Memory可以用于需要快速查询的数据时进行使用，比如用户用户会话
```

ibdata1存放所有使用InnoDB表中的数据以及索引信息（共享表空间）

## 										表的操作

create table 表名

​	（字段名	数据类型  [完整性约束条件]..

​		  字段名2	数据类型	[完整性约束条件]..);

什么是完整性约束条件?

约束条件指的是对字段进行限制，要求用户向字段中写入符合要求的数据，一旦用户写入的内容不符合要求，将会写入失败，为了保证数据的完整性

约束条件

primary key		标识该属性为该表的主键，用于唯一的标识对应的数据

foreign key			标识该属性为该表的外键，外键关联需要另外一表的主键

not  null				标识该属性不能为空值

unique					标识该属性值唯一

default					给该属性设置默认值

auto_increment		标识该属性的值自动增加



primary key	主键，标识表中的数据唯一且非空，且在一个表中只允许出现一个主键，适合给数据本身具有唯一非空性质的数据进行添加，例如身份证号

建立主键的语法

1.字段名	数据类型	primary key

2.在定义完所有的列之后建立主键

primary	key	（要定义主键的字段）

```
mysql> create database sjk;
Query OK, 1 row affected (0.00 sec)

mysql> use sjk;
Database changed
mysql> create table example1
    -> (s_id int primary key,
    -> s_name varchar(30),
    -> s_sex  char(3));
mysql> insert into example1 values (1,'user1','m');
mysql> insert into example1 values (1,'user1','m');
ERROR 1062 (23000): Duplicate entry '1' for key 'PRIMARY'
mysql> insert into example1 values (2,'user1','m');
Query OK, 1 row affected (0.00 sec)
mysql> create table example2(
    -> id int,
    -> name varchar(30),
    -> sex char(3),
    -> primary key(id));
Query OK, 0 rows affected (0.01 sec)
```

联合主键，当单个字段无法确定唯一值时，将多个字段放在一起建立主键

primary key （字段1，字段2...）

```
mysql> create table example3( name varchar(30), birth date, high int,weight int,address varchar(50),primary key (name,birth,high,weight,address));
Query OK, 0 rows affected (0.00 sec)
mysql> insert into example3 values ('user1','1991-01-01',180,85,'beijing');
Query OK, 1 row affected (0.00 sec)

mysql> insert into example3 values ('user1','1991-01-01',180,85,'beijing');
ERROR 1062 (23000): Duplicate entry 'user1-1991-01-01-180-85-beijing' for key 'PRIMARY'
mysql> insert into example3 values ('user2','1991-01-01',180,85,'beijing');
Query OK, 1 row affected (0.00 sec)

mysql> select * from example3;
+-------+------------+------+--------+---------+
| name  | birth      | high | weight | address |
+-------+------------+------+--------+---------+
| user1 | 1991-01-01 |  180 |     85 | beijing |
| user2 | 1991-01-01 |  180 |     85 | beijing |
+-------+------------+------+--------+---------+
2 rows in set (0.00 sec)
```

## 外键

外键用于建立表与表之间的联系，首先联系通过字段进行连接，一旦建立外键之后将会出现父子表，建立（含有）外键的表称之为子表，被晚间连接的表称之为父表，外键在一个表中可以有多列。

## 语法

```
[constraint	约束名] foreign key （定义外键的字段1 ,[字段 2...]）refetences  父表名 （父表主键列）

当填写数据时，父表中被关联的字段拥有某种数据，子表才能填写对应的数据
```

## 建立外键的原则

```
1.子表关联父表时，父表被关联的字段必须为主键
2.建立外键时，数据类型需要一致
3.当父表为联合主键时，需要从第一个字段开始关联，否则失败
4.书写问题
mysql> create table example4( s_id int, course_id int, grade decimal(8,2),primary key(s_id,course_id));
Query OK, 0 rows affected (0.01 sec)
mysql> create table example5(
    -> id int primary key,
    -> c_id int,name varchar(30),birth date,
    -> constraint fk_ex5 foreign key (id) references example4(course_id));
ERROR 1005 (HY000): Can't create table 'sjk.example5' (errno: 150)
mysql> create table example5( id int primary key, c_id int,name varchar(30),birth date, constraint fk_ex5 foreign key (id) references example4(s_id));
Query OK, 0 rows affected (0.00 sec)

mysql> insert into example5 values (1,20,'user1','1999-01-01');
ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails (`sjk`.`example5`, CONSTRAINT `fk_ex5` FOREIGN KEY (`id`) REFERENCES `example4` (`s_id`))
mysql> insert into example4 values (1,20,80);
Query OK, 1 row affected (0.01 sec)

mysql> insert into example5 values (1,20,'user1','1999-01-01');
Query OK, 1 row affected (0.00 sec)

```

## 非空

在定义非空的字段中不允许写入空值

字段名	数据类型	not null

```
mysql> create table example6(id int not null);
Query OK, 0 rows affected (0.00 sec)

mysql> insert into example6 values (null);
ERROR 1048 (23000): Column 'id' cannot be null

```

唯一性约束条件

定义该条件的字段不允许写入重复值

语法

1  字段名	数据类型	unique

2[constraint	约束名 ]	unique	（定义唯一性条件的字段）

```
mysql> create table example7 (
    -> id int not null,
    -> name varchar(30) unique);
Query OK, 0 rows affected (0.00 sec)

mysql> insert into example7 values (1,'zhangsan');
Query OK, 1 row affected (0.01 sec)

mysql> insert into example7 values (2,'zhangsan');
ERROR 1062 (23000): Duplicate entry 'zhangsan' for key 'name'

mysql> create table example8( id int primary key, name varchar(30), constraint ex_uni unique (name));
Query OK, 0 rows affected (0.01 sec)

```

## 默认值

给字段预先设置默认值，如果不往该字段写入数据，mysql会将默认值填写到该字段中

字段名	数据类型	default	默认值

```
mysql> create table example9( id int primary key, name varchar(30) not null, address varchar(30) unique, game varchar(30) default 'LOL');
Query OK, 0 rows affected (0.00 sec)
mysql> insert into example9 (id,name,address) values (1,'xd','beijing');
Query OK, 1 row affected (0.00 sec)

mysql> select * from example9;
+----+------+---------+------+
| id | name | address | game |
+----+------+---------+------+
|  1 | xd   | beijing | LOL  |
+----+------+---------+------+
1 row in set (0.00 sec)

```



## 自增

给指定字段的值进行自动增加的操作，只能对数值进行增加，设置自增为了生成唯一的id值，一个表中只能有一个自增字段

语法

字段名	数据类型	auto_increment

```
mysql> create table example10( id int primary key auto_increment, name varchar(30) not null);
Query OK, 0 rows affected (0.00 sec)

mysql> create table example11( id int unique auto_increment, name varchar(30) not null);
Query OK, 0 rows affected (0.00 sec)

```

